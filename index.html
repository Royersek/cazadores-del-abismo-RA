<!DOCTYPE html>
<html>
<head>
    <title>Cazadores del Abismo - Día 1</title>
    <!-- Importamos las librerías de A-Frame y AR.js -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://ar-js-org.github.io/AR.js/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0px; overflow: hidden;">
    <!-- La escena de A-Frame con la configuración de AR.js -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">

        <!-- Esta es la entidad que maneja la detección de superficies -->
        <a-entity hit-test></a-entity>

        <!-- Este es nuestro cubo. Por ahora está invisible. -->
        <a-box 
            id="mi-cubo" 
            position="0 0.5 -2" 
            rotation="0 45 0" 
            color="#4CC3D9" 
            visible="false">
        </a-box>

        <!-- La cámara que nos permite ver el mundo real -->
        <a-camera camera="active: true"></a-camera>
    </a-scene>

    <script>
        // --- LÓGICA DE INTERACCIÓN ---
        // Esperamos a que la escena esté lista
        document.querySelector('a-scene').addEventListener('loaded', function () {
            
            // Obtenemos la entidad que detecta las superficies
            const hitTestEntity = document.querySelector('[hit-test]');
            // Obtenemos nuestro cubo
            const box = document.querySelector('#mi-cubo');

            // Este evento se dispara cada vez que se detecta una superficie
            hitTestEntity.addEventListener('hit-test-start', function (evt) {
                // Cuando se detecta una superficie, hacemos visible el cubo
                box.setAttribute('visible', 'true');
            });

            // Este evento se dispara constantemente mientras se mueve el móvil
            hitTestEntity.addEventListener('hit-test-achieved', function (evt) {
                // Obtenemos la posición donde se detectó la superficie
                const position = evt.detail.position;
                // Posicionamos el cubo en ese lugar
                box.setAttribute('position', position);
            });

            // Este evento se dispara cuando se pierde la superficie
            hitTestEntity.addEventListener('hit-test-lost', function (evt) {
                // Ocultamos el cubo
                box.setAttribute('visible', 'false');
            });
        });
    </script>
</body>
</html>
